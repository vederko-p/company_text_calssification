# Задача сопоставления наименований компаний

**Постановка задачи**

В качестве данных представлены пары фраз с метками, обозначающими, являются ли
фразы описаниями одной компании. Цель - построить модель, которая сможет сопоставлять
фразы и определять, относятся ли они к одной компании или нет.

[Исходные данные - full_data.csv](https://drive.google.com/drive/folders/1N-s6r0vYi_XO79_Bp8sCsm9ylFFyp3V3?usp=sharing)

## Описание работы модели

На вход модели подается название компании, которое сравнивается с имеющимся списком компаний. 

На первом этапе идет отбор компаний из списка по вхождению слов. Перед этим каждое слово из заданного названия компании проверяется по частотному словарю, чтобы исключить слова, которые встречаются очень часто и поэтому не несут смысловой нагрузки. 

После этого все названия токенизируются при помощи предобученного токенизатора и выравниваются по длине вектора.

На втором этапе, отобранные компании из списка, попарно сравниваются с заданным при помощи сиамской нейронной сети по косинусному расстоянию между векторами. Одинаковыми компаниями считаются те, у которых косинусное расстояние больше подобранного порогового значения.

![модель](https://user-images.githubusercontent.com/64748758/198020372-dbbc1632-4eb2-4312-976f-f1bd5fc9206a.png)

На выходе мы получаем список компаний отсортированный по косинусному расстоянию. 

## Запуск

Необходимо установить зависимости:

    pip install -qr requirements.txt

После всех настроек. Из src:

    python3 test_video.py "Название компании" (название в двойных ковычках)
    
## Результаты обучения моделей

| model     | Parameters                      | Accuracy    |  P  | R    |
| ----------|:-------------------------------:| -----       |-----|------|
| Name comparison | TF-Idf                    |             | 0.89| 0.87 |
| Siamese Network, Bert |LSTM 128, Embeddig 768           | 0.92        | 0.82| 0.84 |
| Siamese Network       |LSTM 64 , Embeddig 100           | 0.97        | 0.94| 0.91 |
| Siamese Network       |LSTM 64 , Embeddig 50            | 0.97        | 0.95| 0.93 |
| Siamese Network       |LSTM 128,64 , Embeddig 150       | 0.97        | 0.93| 0.94 |
| Siamese Network       |LSTM 128,64 , Embeddig 50        | 0.94        | 0.84| 0.95 |
| Siamese Network       |Dense 256,128 , Embeddig 100     | 0.97        | 0.95| 0.94 |
| Siamese Network       |Dense 128 , Embeddig 100         | 0.98        | 0.96| 0.94 |
| Siamese Network       |Dense 64 , Embeddig 50           | 0.92        | 0.82| 0.86 |

## Значение метрики при разном пороге

|   Metric  | Parameters                      | Accuracy    |  P  | R    |
| ----------|:-------------------------------:| -----       |-----|------|
|   Metric  | Parameters                                    |  P  | R    |
| ----------|:------------------------                      |-----|------|
|           | TF-Idf                          |             | 0.89| 0.87 |


